(this.webpackJsonpaibird=this.webpackJsonpaibird||[]).push([[0],{14:function(t,i,e){},15:function(t,i,e){},16:function(t,i,e){"use strict";e.r(i);var n=e(0),a=e.n(n),s=e(5),r=e.n(s),o=(e(14),e(3)),u=e(7),h=e(6),c=e(8),d=e(1),f=e(2),l=(e(15),function(){function t(i,e){var n=this;Object(d.a)(this,t),this.rows=i,this.cols=e,this.data=Array(this.rows).fill().map((function(){return Array(n.cols).fill(0)}))}return Object(f.a)(t,[{key:"copy",value:function(){for(var i=new t(this.rows,this.cols),e=0;e<this.rows;e++)for(var n=0;n<this.cols;n++)i.data[e][n]=this.data[e][n];return i}},{key:"toArray",value:function(){for(var t=[],i=0;i<this.rows;i++)for(var e=0;e<this.cols;e++)t.push(this.data[i][e]);return t}},{key:"randomize",value:function(){return this.map((function(t){return 2*Math.random()-1}))}},{key:"add",value:function(i){return i instanceof t?this.rows!==i.rows||this.cols!==i.cols?void console.log("Columns and Rows of A must match Columns and Rows of B."):this.map((function(t,e,n){return t+i.data[e][n]})):this.map((function(t){return t+i}))}},{key:"multiply",value:function(i){return i instanceof t?this.rows!==i.rows||this.cols!==i.cols?void console.log("Columns and Rows of A must match Columns and Rows of B."):this.map((function(t,e,n){return t*i.data[e][n]})):this.map((function(t){return t*i}))}},{key:"map",value:function(t){for(var i=0;i<this.rows;i++)for(var e=0;e<this.cols;e++){var n=this.data[i][e];this.data[i][e]=t(n,i,e)}return this}},{key:"print",value:function(){return console.table(this.data),this}},{key:"serialize",value:function(){return JSON.stringify(this)}}],[{key:"fromArray",value:function(i){return new t(i.length,1).map((function(t,e){return i[e]}))}},{key:"subtract",value:function(i,e){if(i.rows===e.rows&&i.cols===e.cols)return new t(i.rows,i.cols).map((function(t,n,a){return i.data[n][a]-e.data[n][a]}));console.log("Columns and Rows of A must match Columns and Rows of B.")}},{key:"transpose",value:function(i){return new t(i.cols,i.rows).map((function(t,e,n){return i.data[n][e]}))}},{key:"multiply",value:function(i,e){if(i.cols===e.rows)return new t(i.rows,e.cols).map((function(t,n,a){for(var s=0,r=0;r<i.cols;r++)s+=i.data[n][r]*e.data[r][a];return s}));console.log("Columns of A must match rows of B.")}},{key:"map",value:function(i,e){return new t(i.rows,i.cols).map((function(t,n,a){return e(i.data[n][a],n,a)}))}},{key:"deserialize",value:function(i){"string"==typeof i&&(i=JSON.parse(i));var e=new t(i.rows,i.cols);return e.data=i.data,e}}]),t}()),p=function t(i,e){Object(d.a)(this,t),this.func=i,this.dfunc=e},m=new p((function(t){return 1/(1+Math.exp(-t))}),(function(t){return t*(1-t)})),v=(new p((function(t){return Math.tanh(t)}),(function(t){return 1-t*t})),function(){function t(i,e,n){if(Object(d.a)(this,t),i instanceof t){var a=i;this.input_nodes=a.input_nodes,this.hidden_nodes=a.hidden_nodes,this.output_nodes=a.output_nodes,this.weights_ih=a.weights_ih.copy(),this.weights_ho=a.weights_ho.copy(),this.bias_h=a.bias_h.copy(),this.bias_o=a.bias_o.copy()}else this.input_nodes=i,this.hidden_nodes=e,this.output_nodes=n,this.weights_ih=new l(this.hidden_nodes,this.input_nodes),this.weights_ho=new l(this.output_nodes,this.hidden_nodes),this.weights_ih.randomize(),this.weights_ho.randomize(),this.bias_h=new l(this.hidden_nodes,1),this.bias_o=new l(this.output_nodes,1),this.bias_h.randomize(),this.bias_o.randomize();this.setLearningRate(),this.setActivationFunction()}return Object(f.a)(t,[{key:"predict",value:function(t){var i=l.fromArray(t),e=l.multiply(this.weights_ih,i);e.add(this.bias_h),e.map(this.activation_function.func);var n=l.multiply(this.weights_ho,e);return n.add(this.bias_o),n.map(this.activation_function.func),n.toArray()}},{key:"setLearningRate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.learning_rate=t}},{key:"setActivationFunction",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m;this.activation_function=t}},{key:"train",value:function(t,i){var e=l.fromArray(t),n=l.multiply(this.weights_ih,e);n.add(this.bias_h),n.map(this.activation_function.func);var a=l.multiply(this.weights_ho,n);a.add(this.bias_o),a.map(this.activation_function.func);var s=l.fromArray(i),r=l.subtract(s,a),o=l.map(a,this.activation_function.dfunc);o.multiply(r),o.multiply(this.learning_rate);var u=l.transpose(n),h=l.multiply(o,u);this.weights_ho.add(h),this.bias_o.add(o);var c=l.transpose(this.weights_ho),d=l.multiply(c,r),f=l.map(n,this.activation_function.dfunc);f.multiply(d),f.multiply(this.learning_rate);var p=l.transpose(e),m=l.multiply(f,p);this.weights_ih.add(m),this.bias_h.add(f)}},{key:"serialize",value:function(){return JSON.stringify(this)}},{key:"copy",value:function(){return new t(this)}},{key:"mutate",value:function(t){this.weights_ih.map(t),this.weights_ho.map(t),this.bias_h.map(t),this.bias_o.map(t)}}],[{key:"deserialize",value:function(i){"string"==typeof i&&(i=JSON.parse(i));var e=new t(i.input_nodes,i.hidden_nodes,i.output_nodes);return e.weights_ih=l.deserialize(i.weights_ih),e.weights_ho=l.deserialize(i.weights_ho),e.bias_h=l.deserialize(i.bias_h),e.bias_o=l.deserialize(i.bias_o),e.learning_rate=i.learning_rate,e}}]),t}()),y=500,g=500,w=800,_=25,b=40,k=240,x=function(){function t(i,e){var n=this;Object(d.a)(this,t),this.update=function(t,i,e){n.age+=1,n.gravity+=n.velocity,n.gravity=Math.min(4,n.gravity),n.y+=n.gravity,n.y<0?n.y=0:n.y>g&&(n.y=g),n.think(t,i,e)},this.think=function(t,i,e){var a=[Math.abs((n.x-t)/w),i/g,e/g,n.y/g,n.gravity/4],s=n.brain.predict(a);s[0]<s[1]&&n.jump()},this.mutate=function(){n.brain.mutate((function(t){return Math.random()<.2?t+.05*Math.random():t}))},this.jump=function(){n.gravity=-4},this.ctx=i,this.x=150,this.y=150,this.gravity=0,this.velocity=.1,this.isDead=!1,this.age=0,this.fitness=0,e?(this.brain=e.copy(),this.mutate()):this.brain=new v(5,2,2)}return Object(f.a)(t,[{key:"draw",value:function(t){var i=document.getElementById("image");this.ctx.drawImage(i,this.x,this.y,15,15)}}]),t}(),C=function(){function t(i,e,n){var a=this;Object(d.a)(this,t),this.update=function(){a.x-=1,a.x+_<0&&(a.isDead=!0)},this.ctx=i,this.isDead=!1,this.x=w,this.y=e?g-e:0,this.width=_,this.height=e||b+Math.random()*(g-n-2*b)}return Object(f.a)(t,[{key:"draw",value:function(t){this.ctx.fillRect(this.x,this.y,this.width,this.height),this.ctx.fillStyle="#00c400"}}]),t}(),O=function(t){function i(t){var e;return Object(d.a)(this,i),(e=Object(u.a)(this,Object(h.a)(i).call(this,t))).startGame=function(){e.GenCount++;var t=e.canvasRef.current.getContext("2d");e.frameCount=0,clearInterval(e.loop),t.clearRect(0,0,w,g),e.pipes=e.generatePipes(),e.birds=e.generateBirds(),e.deadBirds=[],e.loop=setInterval(e.gameloop,1e3/e.state.gameSpeed)},e.onKeyDown=function(t){"Space"===t.code&&e.birds[0].jump()},e.getCtx=function(){return e.canvasRef.current.getContext("2d")},e.generatePipes=function(){var t=e.getCtx(),i=new C(t,null,e.space),n=g-i.height-e.space;return[i,new C(t,n,80)]},e.generateBirds=function(){for(var t=[],i=e.getCtx(),n=0;n<y;n++){var a=e.deadBirds.length&&e.pickOne().brain,s=new x(i,a);t.push(s)}return t},e.gameloop=function(){e.update(),e.draw()},e.update=function(){var t;if(e.frameCount=e.frameCount+1,e.frameCount%240===0){var i,n=e.generatePipes();(i=e.pipes).push.apply(i,Object(o.a)(n))}if(e.frameCount>e.highScore&&(e.highScore=e.frameCount),e.pipes.forEach((function(t){return t.update()})),e.birds.forEach((function(t){var i=e.getNextPipe(t),n=i.y+i.height;t.update(i.x,n,n+e.space)})),e.pipes=e.pipes.filter((function(t){return!t.isDead})),e.updateBirdDeadState(),(t=e.deadBirds).push.apply(t,Object(o.a)(e.birds.filter((function(t){return t.isDead})))),e.birds=e.birds.filter((function(t){return!t.isDead})),0===e.birds.length){var a=0;e.deadBirds.forEach((function(t){a+=t.age})),e.deadBirds.forEach((function(t){t.fitness=t.age/a})),e.startGame()}},e.pickOne=function(){for(var t=0,i=Math.random();i>0;)i-=e.deadBirds[t].fitness,t+=1;return t-=1,e.deadBirds[t]},e.getNextPipe=function(t){for(var i=0;i<e.pipes.length;i++)if(e.pipes[i].x>t.x)return e.pipes[i]},e.updateBirdDeadState=function(){e.birds.forEach((function(t){e.pipes.forEach((function(i){(t.y<=0||t.y>=g||t.x>=i.x&&t.x<=i.x+i.width&&t.y>=i.y&&t.y<=i.y+i.height)&&(t.isDead=!0)}))}))},e.tick=function(){e.setState({})},e.canvasRef=a.a.createRef(),e.frameCount=0,e.GenCount=0,e.highScore=0,e.space=200,e.pipes=[],e.birds=[],e.deadBirds=[],e.state={gameSpeed:k},e}return Object(c.a)(i,t),Object(f.a)(i,[{key:"componentDidMount",value:function(){var t=this;this.clockID=setInterval((function(){return t.tick()}),1),this.startGame()}},{key:"draw",value:function(){this.canvasRef.current.getContext("2d").clearRect(0,0,w,g),this.pipes.forEach((function(t){return t.draw()})),this.birds.forEach((function(t){return t.draw()}))}},{key:"reset",value:function(){}},{key:"render",value:function(){var t=this;return a.a.createElement("div",{className:"App"},a.a.createElement("div",{onClick:function(){return t.setState({})}},"GEN:  ",this.GenCount," , BIRD: ",this.birds.length,", SCORE: ",(this.frameCount/240-2.3).toFixed(0),", HIGHSCORE:",(this.highScore/240-2.3).toFixed(0)),a.a.createElement("canvas",{ref:this.canvasRef,width:"800",height:"500",style:{marginTop:"24px",border:"1px solid #c3c3c3"}}),a.a.createElement("div",null),a.a.createElement("img",{id:"image",width:"0",height:"0",src:"https://tr.seaicons.com/wp-content/uploads/2017/03/Bird-yellow-icon.png"}))}}]),i}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(a.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))},9:function(t,i,e){t.exports=e(16)}},[[9,1,2]]]);
//# sourceMappingURL=main.b049fc76.chunk.js.map